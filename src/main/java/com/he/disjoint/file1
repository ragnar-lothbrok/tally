SELECT plat.domain_id, plat.lpfBids, plat.ffBids, plat.lbBids, plat.lpfAmt, "
    "plat.cfBids, plat.sbffBids, plat.dwlfBids, plat.ffAmt, plat.lbAmt, plat.cfAmt, plat.sbffAmt, plat.dwlfAmt,"
    "a.id AS advId,  a.name AS advName,  d.domain AS domainName, if((select count(*) from KomliAdServer.acl_resource_feature where resource_id =:pubId and resource_type_id = 1 and feature_id = 116),iab.id,cat.id) AS catId,   "
    "if((select count(*) from KomliAdServer.acl_resource_feature where resource_id =:pubId and resource_type_id = 1 and feature_id = 116), if((iab.iab_cat_name IS NULL), '', iab.iab_cat_name),if ((cat.name IS NULL), '', cat.name)) AS catName FROM "
    "(select domain_id, sum(block_count_by_LPF) as lpfBids, "
    "sum(block_count_by_FF) as ffBids, sum(block_count_by_LB) as lbBids, sum(lost_bid_amount_due_to_LPF) as lpfAmt, "
    "sum(block_count_by_CRNA+block_count_by_CRF) as cfBids, sum(block_count_by_SBFF) as sbffBids, "
    "sum(block_count_by_DWLF) as dwlfBids,"
    "sum(lost_bid_amount_due_to_FF) as ffAmt, sum(lost_bid_amount_due_to_LB) as lbAmt, "
    "sum(lost_bid_amount_due_to_CRNA+lost_bid_amount_due_to_CRF) as cfAmt, sum(lost_bid_amount_due_to_SBFF) as sbffAmt, "
    "sum(lost_bid_amount_due_to_DWLF) as dwlfAmt "
            "FROM advertiser_buyer_platform_level_report "
    "force index (unique_key_constraint) where pub_id = :pubId  and site_id=:siteId :platformFilter and "
    "from_date between :fromDate and :toDate and time_frame_type=:timeFrameType :buyerFilter :dspFilter :domainFilter group by domain_id) plat "
    "LEFT JOIN AdFlex.advertiser_domain d ON plat.domain_id = d.id LEFT JOIN AdFlex.advertiser_domain_category_mapping catm "
    "ON plat.domain_id = catm.domain_id LEFT JOIN AdFlex.advertiser_category cat ON catm.category_id = cat.id LEFT JOIN "
    "AdFlex.advertiser a ON d.advertiser_id = a.id LEFT JOIN KomliAdServer.iab_categories iab ON catm.int_primary_iab_category_id=iab.id GROUP BY plat.domain_id";